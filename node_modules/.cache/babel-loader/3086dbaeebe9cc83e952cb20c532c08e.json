{"ast":null,"code":"var _jsxFileName = \"/Users/hyunobae/dev/jamaica/src/providers/WalletProvider.tsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport WalletContext, { initialWalletContext } from '../contexts/WalletContext';\nimport UserType from '../enums/UserType';\nimport { useWeb3React } from '@web3-react/core';\nimport InjectedConnector from '../core/connectors/injectedConnector';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst WalletProvider = props => {\n  _s();\n\n  const {\n    account,\n    chainId,\n    activate,\n    active\n  } = useWeb3React();\n  const [state, setState] = useState(initialWalletContext);\n  const TempCollateralAddress = \"0x6A040998EeB628Cf40683833812F0463C4FC79F9\";\n  const TempBorrowerAddress = \"0xB91e9f737B2227E92A373fb071b66B10eC6770d0\";\n  let throttle_flag = false;\n\n  const throttle = (func, delay) => {\n    if (!throttle_flag) {\n      func();\n      throttle_flag = true;\n      setTimeout(() => {\n        throttle_flag = false;\n      }, delay);\n    }\n  };\n\n  const [tried, setTried] = useState(false);\n  useEffect(() => {\n    InjectedConnector.isAuthorized().then(isAuthorized => {\n      if (isAuthorized) {\n        activate(InjectedConnector, undefined, true).catch(() => {\n          setTried(true);\n        });\n      } else {\n        setTried(true);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    if (!tried && active) {\n      setTried(true);\n    }\n  }, [tried, active]);\n\n  const InitialState = () => {\n    if (account) {\n      throttle(() => setState({ ...state,\n        address: account\n      }), 500);\n    }\n\n    setState({ ...state,\n      active: !!account,\n      chainId: chainId\n    });\n\n    switch (account) {\n      case TempCollateralAddress:\n        setState({ ...state,\n          userType: UserType.Collateral\n        });\n        break;\n\n      case TempBorrowerAddress:\n        setState({ ...state,\n          userType: UserType.Borrowers\n        });\n        break;\n\n      default:\n        if (!!account) {\n          setState({ ...state,\n            userType: UserType.Guest\n          });\n        } else {\n          setState({ ...state,\n            userType: UserType.User\n          });\n        }\n\n    }\n  };\n\n  const activateWallet = () => {\n    activate(InjectedConnector);\n    console.log(state);\n    InitialState();\n  };\n\n  useEffect(() => {\n    InitialState();\n    console.log(state);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(WalletContext.Provider, {\n    value: { ...state,\n      activateWallet\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n};\n\n_s(WalletProvider, \"OieRmUoQvbGVOrQ2jHlEw3RkFiM=\", false, function () {\n  return [useWeb3React];\n});\n\n_c = WalletProvider;\nexport default WalletProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"WalletProvider\");","map":{"version":3,"sources":["/Users/hyunobae/dev/jamaica/src/providers/WalletProvider.tsx"],"names":["useEffect","useState","WalletContext","initialWalletContext","UserType","useWeb3React","InjectedConnector","WalletProvider","props","account","chainId","activate","active","state","setState","TempCollateralAddress","TempBorrowerAddress","throttle_flag","throttle","func","delay","setTimeout","tried","setTried","isAuthorized","then","undefined","catch","InitialState","address","userType","Collateral","Borrowers","Guest","User","activateWallet","console","log","children"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\nimport WalletContext, { initialWalletContext, IWalletContext } from '../contexts/WalletContext';\nimport UserType from '../enums/UserType';\nimport { useWeb3React } from '@web3-react/core';\nimport InjectedConnector from '../core/connectors/injectedConnector';\ninterface IProps {\n  triedEager: any\n}\n\nconst WalletProvider: React.FC<IProps> = (props: any) => {\n  const { account, chainId, activate, active } = useWeb3React();\n  const [state, setState] = useState<IWalletContext>(initialWalletContext);\n\n  const TempCollateralAddress = \"0x6A040998EeB628Cf40683833812F0463C4FC79F9\";\n  const TempBorrowerAddress = \"0xB91e9f737B2227E92A373fb071b66B10eC6770d0\";\n\n  let throttle_flag = false;\n  const throttle = (func: () => void, delay: number) => {\n    if (!throttle_flag) {\n      func();\n      throttle_flag = true;\n      setTimeout(() => {\n        throttle_flag = false;\n      }, delay);\n    }\n  };\n  const [tried, setTried] = useState(false);\n\n  useEffect(() => {\n    InjectedConnector.isAuthorized().then((isAuthorized: boolean) => {\n      if (isAuthorized) {\n        activate(InjectedConnector, undefined, true).catch(() => {\n          setTried(true);\n        });\n      } else {\n        setTried(true);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    if (!tried && active) {\n      setTried(true);\n    }\n  }, [tried, active]);\n  \n  const InitialState = () => {\n    if (account) {\n      throttle(() => setState({ ...state, address: account }), 500);\n    }\n    setState({ ...state, active: !!account, chainId: chainId });\n\n    switch (account) {\n      case TempCollateralAddress:\n        setState({ ...state, userType: UserType.Collateral })\n        break;\n      case TempBorrowerAddress:\n        setState({ ...state, userType: UserType.Borrowers })\n        break;\n      default:\n        if(!!account) {\n          setState({ ...state, userType: UserType.Guest })\n        } else {\n          setState({ ...state, userType: UserType.User })\n        }\n    }\n  }\n\n  const activateWallet = () => {\n    activate(InjectedConnector)\n    console.log(state)\n    \n    InitialState()\n  }\n\n  useEffect(() => {\n    InitialState()\n    console.log(state)\n  }, []);\n\n\n  return (\n    <WalletContext.Provider value={{\n      ...state,\n      activateWallet\n    }}>\n      {props.children}\n    </WalletContext.Provider>\n  );\n}\n\nexport default WalletProvider;"]},"metadata":{},"sourceType":"module"}